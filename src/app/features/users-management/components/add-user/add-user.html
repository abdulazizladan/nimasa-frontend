<h2 mat-dialog-title class="text-indigo-700 font-bold">Create New User</h2>
    
    <form [formGroup]="form" (ngSubmit)="onSubmit()" mat-dialog-content class="flex flex-col gap-4 p-4">
      
      <!-- Email and Password -->
      <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" placeholder="email@example.com" />
          @if (form.get('email')?.hasError('required') && form.get('email')?.touched) {
            <mat-error>Email is required</mat-error>
          } @else if (form.get('email')?.hasError('email') && form.get('email')?.touched) {
            <mat-error>Enter a valid email format</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Password</mat-label>
          <input matInput type="password" formControlName="password" placeholder="Secure Password" />
          @if (form.get('password')?.hasError('required') && form.get('password')?.touched) {
            <mat-error>Password is required</mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Role Select -->
      <mat-form-field appearance="outline">
        <mat-label>Role</mat-label>
        <mat-select formControlName="role" placeholder="Select role">
          <!-- Roles are "admin" and "guest" -->
          <mat-option value="admin">Admin</mat-option>
          <mat-option value="guest">Guest</mat-option>
        </mat-select>
        @if (form.get('role')?.hasError('required') && form.get('role')?.touched) {
          <mat-error>Role is required</mat-error>
        }
      </mat-form-field>

      <!-- Personal Information Group -->
      <div formGroupName="info" class="p-4 border border-indigo-200 rounded-lg space-y-4">
        <h3 class="text-md font-semibold text-indigo-600">Personal Information</h3>
        
        <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
          <mat-form-field appearance="outline" class="w-full">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" placeholder="First Name" />
            @if (form.get('info.firstName')?.hasError('required') && form.get('info.firstName')?.touched) {
              <mat-error>First name is required</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" placeholder="Last Name" />
            @if (form.get('info.lastName')?.hasError('required') && form.get('info.lastName')?.touched) {
              <mat-error>Last name is required</mat-error>
            }
          </mat-form-field>
        </div>
        
        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Image URL (Optional)</mat-label>
          <input matInput type="url" formControlName="image" placeholder="https://example.com/avatar.jpg" />
        </mat-form-field>
      </div>

      <!-- Contact Group -->
      <div formGroupName="contact" class="p-4 border border-indigo-200 rounded-lg space-y-4">
        <h3 class="text-md font-semibold text-indigo-600">Contact</h3>
        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Phone</mat-label>
          <input matInput type="tel" formControlName="phone" placeholder="+1 555 123 4567" />
        </mat-form-field>
      </div>
    </form>
    
    <!-- Actions -->
    <mat-dialog-actions align="end" class="p-4">
      <!--<button mat-button (click)="dialogRef.close(false)">Cancel</button>-->
      <button mat-flat-button color="primary" type="submit" (click)="onSubmit()" 
              [disabled]="form.invalid || isSubmitting">
        @if (isSubmitting) {
          Saving...
        } @else {
          Save User
        }
      </button>
    </mat-dialog-actions>